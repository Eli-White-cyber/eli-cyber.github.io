<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Elijah White — Cyber Portfolio</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">

  <!-- CSS -->
  <link rel="stylesheet" href="style.css">
</head>
<body data-theme="light">

  <!-- LEFT NAV -->
  <nav class="nav-left" aria-label="Main navigation">
    <div class="brand">
      <div class="logo">EW</div>
      <div class="brand-text">
        <div class="name">Elijah White</div>
        <div class="sub">Cyber Portfolio</div>
      </div>
    </div>

    <ul class="nav-links">
      <li><a href="index.html" class="nav-link">Home</a></li>
      <li><a href="posts.html" class="nav-link">All Posts</a></li>
      <li><a href="about.html" class="nav-link">About Me</a></li>
      <li><a href="projects.html" class="nav-link">Projects</a></li>
    </ul>

    <div class="nav-bottom">
      <button class="toggle">Toggle Dark Mode</button>
      <div class="small-note">JetBrains × Clean Tech</div>
    </div>
  </nav>

  <!-- CONTENT WRAPPER -->
  <div class="content-wrapper">

    <!-- CENTER / MAIN -->
    <main class="center-column">

      <!-- HERO -->
      <header class="hero">
        <h1>Elijah White</h1>
        <h2 class="hero-sub">Cybersecurity Major · CS Minor · Aspiring HSI/FBI Cyber Agent</h2>
        <p class="hero-blurb">Daily cyber intel, technical writeups, and projects on threat analysis, network security, and incident response.</p>
      </header>

      <!-- POSTS FEED (dynamic) -->
      <section id="feed" class="feed">
        <!-- posts will be injected here -->
      </section>

      <!-- ARTICLE VIEW -->
      <article id="article-view" class="article-view" hidden>
        <a id="close-article" class="close-article">← Back to feed</a>
        <div id="article-content"></div>
      </article>
    </main>

    <!-- RIGHT PANEL -->
    <aside class="right-column" aria-label="Info and live feed">

      <!-- Meta Card -->
      <section class="card" id="meta-card">
        <h3>Article Info</h3>
        <div id="meta-content">
          <p>Select a post to view details and related tags.</p>
        </div>
      </section>

      <!-- Skills & Certs -->
      <section class="card">
        <h3>Skills & Certs</h3>
        <ul class="small-list">
          <li>CompTIA Security+, Network+</li>
          <li>CCNA (in progress), CySA+ (studying)</li>
          <li>Network Security · Incident Response · Threat Intel</li>
          <li>Python · C++ · Log Analysis · OSINT</li>
        </ul>
      </section>

      <!-- Live Feed -->
      <section class="card" id="live-feed-card">
        <h3>Live Cyber Intel</h3>
        <div id="live-feed">
          <p class="muted">Loading live feed…</p>
        </div>
        <small class="muted">Source: CISA / public feeds</small>
      </section>

    </aside>
  </div>

  <!-- SCRIPTS -->
  <script>
  const POST_JSON = 'posts/post.json';

  // Theme toggle
  const body = document.body;
  const toggleBtn = document.querySelector('.toggle');
  if (localStorage.getItem('theme')) {
    body.setAttribute('data-theme', localStorage.getItem('theme'));
  }
  toggleBtn.addEventListener('click', () => {
    const next = body.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
    body.setAttribute('data-theme', next);
    localStorage.setItem('theme', next);
  });

  // helper
  function htmlToElement(html) {
    const template = document.createElement('template');
    template.innerHTML = html.trim();
    return template.content.firstElementChild;
  }

  // load posts
  async function loadFeed() {
    try {
      const res = await fetch(POST_JSON);
      if (!res.ok) throw new Error('posts JSON not found');
      const posts = await res.json();
      const feed = document.getElementById('feed');
      feed.innerHTML = '';

      posts.forEach(post => {
        const tags = (post.tags || []).map(t => `<span class="tag">${t}</span>`).join(' ');
        const html = `
          <article class="post-card" data-file="${post.file}" data-tags='${JSON.stringify(post.tags||[])}'>
            <h3 class="post-title">${post.title}</h3>
            <div class="tag-row">${tags}</div>
            <p class="post-excerpt">${post.preview || ''}</p>
            <div class="post-actions">
              <button class="open-btn">Open</button>
              <a class="open-new" href="posts/${post.file}" target="_blank">Open in new tab</a>
            </div>
          </article>
        `;
        const el = htmlToElement(html);
        el.querySelector('.open-btn').addEventListener('click', () => openArticle(post));
        feed.appendChild(el);
      });
    } catch (err) {
      console.error(err);
      document.getElementById('feed').innerHTML = '<p class="muted">Failed to load posts.json</p>';
    }
  }

  // open article in-page
  async function openArticle(postMeta) {
    try {
      const res = await fetch('posts/' + postMeta.file);
      if (!res.ok) throw new Error('Post file not found');
      const html = await res.text();
      document.getElementById('article-content').innerHTML = html;
      document.getElementById('article-view').hidden = false;
      document.getElementById('feed').hidden = true;

      updateMetaCard(postMeta);
      window.scrollTo({top:0, behavior:'smooth'});
    } catch (err) {
      console.error(err);
      alert('Failed to load post: ' + err.message);
    }
  }

  document.getElementById('close-article').addEventListener('click', () => {
    document.getElementById('article-view').hidden = true;
    document.getElementById('feed').hidden = false;
  });

  function updateMetaCard(postMeta) {
    const container = document.getElementById('meta-content');
    const tags = (postMeta.tags || []).map(t => `<span class="tag small">${t}</span>`).join(' ');
    container.innerHTML = `
      <p><strong>${postMeta.title}</strong></p>
      <div class="meta-tags">${tags}</div>
    `;
  }

  document.addEventListener('DOMContentLoaded', loadFeed);
  </script>

</body>
</html>
